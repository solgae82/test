
연관관계 설정으로 연동 삽입되는 부분을 이해해야한다.
다음 연관관계매핑_예제부터는
아래와 같은 테이블이 생성된 이후 상황을 가정해서 연관관계매핑을 설명한다

@ManyToOne 속성
	optional: 연관된 엔티티가 반드시 존재해야 하는지 여부 (기본: true)
		- true:없어도 된다, 
		- false: 있어야 한다
		
	fetch: 글로벌 페지 전략 설정(기본: EAGER)
		- EAGER:연관 엔티티 동시조회, 
		- LAZY:연관 엔티티 사용할때 조회
				
	casecade: 영속성 전이 기능 설정
		CasecadeType.ALL : cascade all operation
		CasecadeType.PERSIST : cascade persist operation
		CasecadeType.MERGE : cascade merge operation
		CasecadeType.REMOVE : cascade remove operation
		CasecadeType.REFRESH : cascade refresh operation
		CasecadeType.DETACH : cascade detach operation
	
	targetEntity: 연관된 엔티티의 클래스를 명시적으로 지정하며, 제네릭을 사용하지 않을 때 사용하지만, 
		보통 필드 타입으로 자동으로 설정되어 잘 사용하지 않습니다
		
------------------- application.properties

# DataSource Setting
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.username=sa
spring.datasource.password=

# JPA Setting
spring.jpa.hibernate.ddl-auto=create #처음 생성
spring.jpa.generate-ddl=false
spring.jpa.show-sql=true
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.properties.hibernate.format_sql=true

# Logging Setting
logging.level.org.hibernate=info

------------------- board.java

package com.solgae.domain;

import java.time.LocalDateTime;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.ManyToOne;
import lombok.Getter;
import lombok.Setter;
import lombok.ToString;

@Getter
@Setter
@ToString
@Entity
public class Board {

	@Id
	@GeneratedValue
	private Long seq;
	private String title;
	
	@ManyToOne // N대1 설정
	@JoinColumn(name="MEMBER_ID")
	private Member member;
	
	private String content;
	private LocalDateTime createDate;
	private Long cnt;
	
}

------------------- member.java

package com.solgae.domain;

import java.util.ArrayList;
import java.util.List;

import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.Id;
import jakarta.persistence.OneToMany;
import lombok.Getter;
import lombok.Setter;
import lombok.ToString;

@Getter
@Setter
@ToString
@Entity
public class Member {

	@Id
	@Column(name ="MEMBER_ID")
	private String id;
	private String password;
	private String name;
	private String role;
	
}

------------------- board 리포지토리 생성

package com.solgae.repositary;

import org.springframework.data.querydsl.QuerydslPredicateExecutor;
import org.springframework.data.repository.CrudRepository;

import com.solgae.domain.Board;

public interface DynamicBoardRepositary extends CrudRepository<Board, Long>, QuerydslPredicateExecutor<Board> {

}

------------------- member 리포지토리 생성

package com.solgae.repositary;

import org.springframework.data.repository.CrudRepository;

import com.solgae.domain.Member;

public interface MemberRepositary extends CrudRepository<Member, String> {

}

------------------- 테스트

package com.solgae.mapping;

import java.time.LocalDateTime;
import java.util.List;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import com.solgae.domain.Board;
import com.solgae.domain.Member;
import com.solgae.repositary.DynamicBoardRepositary;
import com.solgae.repositary.MemberRepositary;

@SpringBootTest
public class RelationMappingTest {

	@Autowired
	private DynamicBoardRepositary boardRepositary;
	
	@Autowired
	private MemberRepositary memberRepositary;
	
		
	// 자료 넣기, create 상태로 테스트
	@Test
	public void testManyToOneInsert() {
		
		Member member1 = new Member();
		member1.setId("member1");
		member1.setPassword("member111");
		member1.setName("둘리");
		member1.setRole("User");
		memberRepositary.save(member1);
		
		
		Member member2 = new Member();
		member2.setId("member2");
		member2.setPassword("member222");
		member2.setName("도우너");
		member2.setRole("Admin");
		memberRepositary.save(member2);
		
		for(int i=1; i<=3; i++) {
			Board board = new Board();
			board.setTitle("둘리가 등록한 게시글 "+i);
			board.setMember(member1);  // <=요기, 'MEMBER_ID' 컬럼에 member1.getId() 값 삽입
			board.setContent("둘리가 등록한 게시글 내용 " + i);
			board.setCreateDate(LocalDateTime.now());
			board.setCnt(0L);
			boardRepositary.save(board);
		}
		
		for(int i=1; i<=3; i++) {
			Board board = new Board();
			board.setTitle("도우너가 등록한 게시글 "+i);
			board.setMember(member2); // <=요기, 'MEMBER_ID' 컬럼에 member2.getId() 값 삽입
			board.setContent("도우너가 등록한 게시글 내용 " + i);
			board.setCreateDate(LocalDateTime.now());
			board.setCnt(0L);
			boardRepositary.save(board);
		}
	}
	
	
	
}


------------------- 생성된 MEMBER 테이블
SELECT * FROM MEMBER;

MEMBER_ID  	NAME  	PASSWORD  	ROLE  
member1		둘리	member111	User
member2		도우너	member222	Admin


------------------- 생성된 BOARD 테이블
SELECT * FROM BOARD;

CNT  	CREATE_DATE  			SEQ  	CONTENT  		MEMBER_ID  	TITLE  
0	2026-01-10 10:24:35.782878	1	둘리가 등록한 게시글 내용 1	member1		둘리가 등록한 게시글 1
0	2026-01-10 10:24:35.796876	2	둘리가 등록한 게시글 내용 2	member1		둘리가 등록한 게시글 2
0	2026-01-10 10:24:35.799876	3	둘리가 등록한 게시글 내용 3	member1		둘리가 등록한 게시글 3
0	2026-01-10 10:24:35.802875	4	도우너가 등록한 게시글 내용 1	member2		도우너가 등록한 게시글 1
0	2026-01-10 10:24:35.805878	5	도우너가 등록한 게시글 내용 2	member2		도우너가 등록한 게시글 2
0	2026-01-10 10:24:35.808877	6	도우너가 등록한 게시글 내용 3	member2		도우너가 등록한 게시글 3


