java api 중에서 SecureRandom은 기본 적으로 랜덤값을 생성할때 CPU온도 및 하드웨어 정보를 가지고

엔트로피값을 생성한다고 합니다.

그래서 가상환경에서 톰캣이 기본 옵션일 경우 java의 heap이 꽉차게 되어서 톰캣이 느려지는 경우가 발생한다.

가상환경의 경우에는 톰캣 옵션으로 하드웨어 정보를 가지고 엔드로피를 생성하지 못하도록 설정합니다.
-------------------

자바의 SecureRandom은 초기화 시 고품질의 난수를 생성하는데, 
/dev/random과 같은 소스는 난수가 부족하면 블로킹(대기) 상태가 되어 애플리케이션 시작이 느려질 수 있습니다.

file:/dev/./urandom을 지정하면 /dev/urandom (운영체제의 난수 풀 사용)을 사용하게 되어 블로킹 없이 
즉시 난수를 얻을 수 있어 성능이 향상됩니다. 

JVM 옵션 중 Djava.security.egd 값 , 또는 java.security 옵션 중 securerandom.source 값을
/dev/random  에서 /dev/urandom 으로 변경한다.

-------------------

/dev/./urandom 사용 이유: 
	과거 특정 Java 버전(Java 5 이상)의 버그로 인해 단순한 /dev/urandom 경로가 무시되는 경우가 있었습니다. 
	/dev/./urandom과 같이 경로를 약간 모호하게 지정하면 
	Java가 SHA1PRNG 알고리즘을 사용하도록 강제하여 이 문제를 우회할 수 있습니다. 
	
	최신 Java 버전 및 OS에서는 /dev/urandom만으로도 충분할 수 있지만, 
	호환성을 위해 /dev/./urandom이 널리 사용됩니다. 

-------------------

윈도우에서 실행 시 리눅스 경로(/dev/)를 그대로 사용하는데, 
이는 JVM이 해당 경로를 찾는다 기보다는 
자바 라이브러리가 내부적으로 처리하는 방식이거나, 
크로스 플랫폼 호환성을 위한 것이므로 문제가 없습니다. 

------------------- 실전 적용

검색해 본 바에 의하면
톰갯 구동시 JAVA_OPTS를 설정해주는 위치가 4가지 정도 있던데,

	1. bash 환경변수로 만들어서 적용하기 
		/etc/profile 또는 /etc/profile.d/java.sh 파일 만들어서 넣기
			JAVA_OPTS="$JAVA_OPTS -Djava.security.egd=file:/dev/./urandom"

	2. 자바홈/../java.security 파일에 설정해서 적용하기
		
		jdk 8 이하 : $JAVA_HOME/jre/lib/security/java.security
		jdk 9 이상 : $JAVA_HOME/conf/security/java.security
		
		# 아래 내용 변경
		#securerandom.source=file:/dev/random(아래로 변경)
		securerandom.source=file:/dev/./urandom 

	3. 톰캣홈/bin/setenv.sh 만들어서(생성) 적용하기
		JAVA_OPTS="$JAVA_OPTS -Djava.security.egd=file:/dev/./urandom"

	4. 톰캣홈/bin/catalina.sh 상단에 직접 적용하기 
		JAVA_OPTS="$JAVA_OPTS -Djava.security.egd=file:/dev/./urandom"


1번은 centos에서 아무리 적용해 봐도 안 되었고, 
2번은 적용되었다..
	
3번과 4번도 적용되었다
	securerandom.source=file:/dev/urandom(x)
	securerandom.source=file:/dev/./urandom (버그 때문에 이렇게 수정해야 한다고라고 함)
처럼 ./을 넣어서 수정하면 되더라..

3번과 4번은 적용 후  
	ps -ef | grep tomcat 

명령어로 검색 출력된 옵션 텍스트 중에

	-Djava.security.egd=file:/dev/./urandom 

위와 같이 톰캣 옵션이 적용되었는지 확인하면 된다.

윈도우즈도 catalina.bat 또는 java.security 에 적용하면 될 듯 하다.

#이왕이면 3번으로 하자(이게 공식방법:톰캣홈/bin/catalina.sh 은 건들지 말라)

